With the above (directed) graph, we simply solve a standard $k-$shortest path problem where the `length' of a path is the sum of the weights of all the edges and nodes that it contains. This yields $k$ itineraries that satisfy crew rules.